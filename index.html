<body>
  <!-- ÜST MENÜ -->
  <header class="main-header">
    <div class="nav-left">
      <img src="images/floop-mascot.png" class="logo-icon" alt="Floop" />
      <h1 class="logo-text">Floop.fun</h1>
    </div>
    <div class="nav-right">
      <button id="connectWallet" class="connect-btn">bağlamak</button>
      <button class="icon-btn" id="searchBtn">🔍</button>
      <button class="icon-btn" id="menuBtn">☰</button>
    </div>
  </header>

  <!-- MOBİL MENÜ -->
  <div class="mobile-menu" id="mobileMenu">
    <ul>
      <li><span>✨</span> bir tarikat başlatın (ücretsiz!)</li>
      <li><span>📄</span> Uwu bu ne</li>
      <li><span>🔍</span> Solscan'da BOOP</li>
      <li><span>✈️</span> telegrama katıl</li>
      <li><span>𝕏</span> x'i takip et</li>
    </ul>
  </div>

  <!-- HERO -->
  <main class="hero-section">
    <div class="hero-content">
      <h2 class="hero-title">Launch Your Meme Token</h2>
      <!-- ALT YAZI KALDIRILDI -->
      <button id="launchBtn" class="launch-btn">Release The Chaos</button>
    </div>
  </main>

  <!-- ORTA FİLTRE BUTONLARI -->
  <section class="filter-bar">
    <button class="filter-btn active">Yeni Başlatıldı</button>
    <button class="filter-btn">Mezun Olmak Üzere</button>
    <button class="filter-btn">En Yüksek MCAP</button>
    <button class="filter-btn">Hacme Göre</button>
    <button class="filter-btn">En Çok Flooplananlar</button>
  </section>

  <!-- CHAOS ANİMASYONU -->
  <section id="chaosAnimation" class="chaos-animation">
    <div class="chaos-container">
      <img src="images/solana.svg" alt="Solana" class="solana-bounce" />
      <img src="images/fire.gif" alt="Fire" class="chaos-fire" />
      <img src="images/floop-mascot.png" alt="Mascot" class="mascot-img" />
    </div>
  </section>
  <!-- TOKEN FORMU -->
  <section id="tokenFormSection" class="form-wrapper hidden">
    <h3>Create Your Token</h3>
    <form id="tokenForm">
      <input type="text" id="tokenName" placeholder="Token Name" required />
      <input type="text" id="tokenSymbol" placeholder="Symbol (e.g. FLOP)" maxlength="5" required />
      <input type="number" id="tokenSupply" placeholder="Total Supply" required min="1" />
      <input type="url" id="tokenImage" placeholder="Image URL (optional)" />
      <textarea id="tokenDescription" placeholder="Describe your token (optional)"></textarea>
      <input type="url" id="socialLink" placeholder="Social Media Link (optional)" />
      <button type="submit">Create Token</button>
    </form>
    <div id="formStatus" class="wallet-status"></div>
  </section>

  <!-- TOP FLOOPED TOKENLAR -->
  <section id="topTokens">
    <h3>Top Flooped Tokens</h3>
    <ul id="topFloopList"></ul>
  </section>
  <!-- FOOTER -->
  <footer>
    <p>&copy; 2025 Floop.fun. All rights reserved.</p>
  </footer>

  <!-- ALT SABİT MENÜ -->
  <nav style="position: fixed; bottom: 0; left: 0; right: 0; background: #0a0a23; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid rgba(255,255,255,0.1); z-index: 999;">
    <div style="text-align:center; color:#fff; font-size:0.9rem;">
      <div>🏠</div>
      <div>cults</div>
    </div>
    <div style="text-align:center; color:#fff; font-size:0.9rem;">
      <div>🎁</div>
      <div>rewards</div>
    </div>
    <div style="text-align:center; color:#fff; font-size:0.9rem;">
      <div>📈</div>
      <div>staking</div>
    </div>
    <div style="text-align:center; color:#fff; font-size:0.9rem;">
      <div>⭐</div>
      <div>leaderb.</div>
    </div>
    <div style="text-align:center; color:#fff; font-size:0.9rem;">
      <div>🎯</div>
      <div>airdrop</div>
    </div>
  </nav>

  <!-- SCRIPT BAŞLANGICI -->
  <script>
    const connectBtn = document.getElementById("connectWallet");
    const launchBtn = document.getElementById("launchBtn");
    const formSection = document.getElementById("tokenFormSection");
    const chaos = document.getElementById("chaosAnimation");
    const mobileMenu = document.getElementById("mobileMenu");
    const menuBtn = document.getElementById("menuBtn");
    let userPublicKey = null;

    // Mobil menü toggle
    let menuOpen = false;
    menuBtn.addEventListener("click", () => {
      menuOpen = !menuOpen;
      mobileMenu.style.display = menuOpen ? "block" : "none";
    });

    // CHAOS TETİĞİ (animasyon göster + 3sn sonra formu aç)
    launchBtn.addEventListener("click", () => {
      chaos.style.display = "flex";
      formSection.classList.add("hidden");
      setTimeout(() => {
        chaos.style.display = "none";
        formSection.classList.remove("hidden");
        formSection.scrollIntoView({ behavior: "smooth" });
      }, 3000);
    });

    // Wallet bağlantısı
    async function connectWallet() {
      if ("solana" in window) {
        const provider = window.solana;
        if (provider.isPhantom) {
          try {
            const response = await provider.connect();
            userPublicKey = response.publicKey;
            connectBtn.innerText = "Connected";
            connectBtn.disabled = true;
          } catch (err) {
            alert("Bağlantı iptal edildi.");
          }
        } else {
          alert("Phantom Wallet yüklü değil.");
        }
      } else {
        alert("Solana tarayıcı desteği yok.");
      }
    }

    connectBtn.addEventListener("click", connectWallet);

    // Supabase bağlantısı
    const supabaseUrl = 'https://ugzbsmmaxxklojwlijrt.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // kısa tutuldu
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // Top Tokenları Yükle
    async function loadTopTokens() {
      const { data, error } = await supabase
        .from('floop_counts')
        .select('*')
        .order('count', { ascending: false })
        .limit(5);

      const list = document.getElementById("topFloopList");
      if (data && data.length > 0) {
        data.forEach((token) => {
          const li = document.createElement("li");
          li.innerHTML = `<a href="token.html?mint=${token.mint}&symbol=FLOOP">${token.mint} — ${token.count} floops</a>`;
          list.appendChild(li);
        });
      } else {
        list.innerHTML = "<li>No tokens yet.</li>";
      }
    }

    loadTopTokens();

    // Token Oluşturma
    const tokenForm = document.getElementById("tokenForm");
    const formStatus = document.getElementById("formStatus");

    tokenForm.addEventListener("submit", async function (e) {
      e.preventDefault();

      const name = document.getElementById("tokenName").value.trim();
      const symbol = document.getElementById("tokenSymbol").value.trim();
      const supply = parseInt(document.getElementById("tokenSupply").value.trim());
      const description = document.getElementById("tokenDescription").value.trim();
      const socialLink = document.getElementById("socialLink").value.trim();
      const imageUrl = document.getElementById("tokenImage").value.trim();

      if (!userPublicKey) {
        formStatus.innerText = "Please connect your wallet first.";
        formStatus.style.color = "orange";
        return;
      }

      formStatus.innerText = "Creating token on Solana...";
      formStatus.style.color = "blue";

      try {
        // Token oluşturma (demo)
        formStatus.innerText = "Token created successfully! (mock)";
        formStatus.style.color = "lime";
      } catch (err) {
        console.error(err);
        formStatus.innerText = "Token creation failed.";
        formStatus.style.color = "red";
      }
    });
  </script>
</body>
</html>
